<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotopia</title>
</head>

<body>
    <h4>Redirecting...</h4>
    <script>
        async function handleHardReload(url) {
            const newUrl = urlWithRndQueryParam(url);
            await fetch(newUrl, {
                headers: {
                    Pragma: 'no-cache',
                    Expires: '-1',
                    'Cache-Control': 'no-cache',
                },
            });
            window.location.href = url;
            // This is to ensure reload with url's having '#'
            window.location.reload();
        }

        handleHardReload(window.location.href);
        console.log("running the js!");
        const urlParams = new URLSearchParams(window.location.search);
        const redirect_url = urlParams.get('u');
        const discord_id = urlParams.get('a');
        const guild_id = urlParams.get('b');
        const discord_name = urlParams.get('c');

        document.cookie = "discord_id=" + discord_id;
        document.cookie = "guild_id=" + guild_id;
        document.cookie = "discord_name=" + discord_name;

        console.log(redirect_url);
        window.location.href = redirect_url;
    </script>

</body>

</html>